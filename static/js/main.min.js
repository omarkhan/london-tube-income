(function(){var t,e,n,a,r,l,c,i,s,o,d,u,p,f,y,x,h,g;u=1700,x=2673.8766,l=1885.32,o=110,h=d3.scale.linear().range([0+o,x-o]),g=d3.scale.linear().domain([0,u]).range([0+o,l-o]),a=function(t,e){return h(e)},r=function(t){return l-g(t.income)},n=function(t){var e;return e=t.getBoundingClientRect(),{left:window.pageXOffset+e.left+e.width/2,top:window.pageYOffset+e.top+e.height/2}},e=d3.svg.line().x(a).y(r).interpolate("cardinal"),d=function(t,e){return function(){var n,a,r,l,c,i,s,o;return i=this,s=i.cloneNode(),s.setAttribute("d",t),l=i.getTotalLength(),c=s.getTotalLength(),a=e/Math.max(l,c),n=function(){var t,e;for(e=[],r=t=0;1>=t;r=t+=a)e.push(r);return e}(),o=n.map(function(t){var e,n;return e=i.getPointAtLength(t*l),n=s.getPointAtLength(t*c),d3.interpolate([e.x,e.y],[n.x,n.y])}),function(e){return 1>e?"M"+o.map(function(t){return t(e)}).join("L"):t}}},i=d3.select("#map"),s=d3.select("#map-content"),t=i.append("g").attr("class","graph"),y=d3.select("#tooltip"),t.append("line").attr("x1",h(0)).attr("y1",l-g(0)).attr("x2",h(u)).attr("y2",l-g(0)),t.append("line").attr("x1",h(0)).attr("y1",l-g(0)).attr("x2",h(0)).attr("y2",l-g(u)),t.selectAll(".y-label").data(g.ticks(4)).enter().append("text").attr("class","y-label").text(function(t){return t.toString()}).attr("x",h(0)-30).attr("y",function(t){return l-g(t)}).attr("dy",15),t.selectAll("y-tick").data(g.ticks(4)).enter().append("line").attr("class","y-tick").attr("x1",h(0)).attr("y1",function(t){return l-g(t)}).attr("x2",h(0)-12).attr("y2",function(t){return l-g(t)}),p=function(){return t.selectAll("path, circle").transition().duration(500).style("opacity",0).transition().remove(),y.style("visibility",null)},f=function(c,o){var u,f;return p(),h.domain([0,o.length-1]),t.selectAll(".x-tick").remove(),t.selectAll(".x-tick").data(o).enter().append("line").attr("class","x-tick").attr("x1",function(t,e){return h(e)}).attr("y1",l-g(0)).attr("x2",function(t,e){return h(e)}).attr("y2",l-g(0)+12),t.selectAll(".x-label").remove(),t.selectAll(".x-label").data(o).enter().append("text").attr("class","x-label").text(function(t){return t.name}).attr("x",function(t,e){return h(e)}).attr("y",l-g(0)+30).attr("transform",function(t,e){return"rotate(-80, "+(h(e)+12)+", "+(l-g(0)+30)+")"}),s.classed("fade",!0),u=i.select("#"+c+" path.main"),f=t.append("path").attr({d:u.attr("d"),style:u.attr("style")}),f.transition().duration(1e3).attrTween("d",d(e(o),10)).each("end",function(){return t.selectAll("circle").data(o).enter().append("circle").style("opacity",0).attr("r",14).attr("cx",a).attr("cy",r).on("mouseover",function(t){var e,a;return y.select(".station-name").text(t.name),y.select(".station-income-amount").text(t.income),a=y.node().getBoundingClientRect(),e=n(this),e.left-=a.width/2,e.top-=a.height+30,y.style({left:""+e.left+"px",top:""+e.top+"px"}),y.style("visibility","visible")}).transition().duration(500).style("opacity",1)})},c=d3.select("#lines"),c.selectAll(".line").data(DATA.lines).each(function(t){var e,n,a,r;return r=t.name,n=t.id,e=t.branches,a=d3.select(this),a.on("click",function(){var t;return a.classed("selected")?(a.classed("selected",!1),p(),s.classed("fade",!1)):(c.select(".line.selected").classed("selected",!1),a.classed("selected",!0),t=a.selectAll(".branch"),t.on("click").call(t.node(),e[0]))}),a.selectAll(".branch").data(e).on("click",function(t){var e;return e=t.stations,d3.event.stopPropagation(),c.selectAll(".branch.selected").classed("selected",!1),this.classList.add("selected"),f(n,e)})})}).call(this);
//# sourceMappingURL=main.map